-- Generated by SQLite Compare utility

-- The script can be used to migrate database
-- C:\Documents and Settings\eventgenie\Desktop\db\eventgenie_40.db schema
-- to the schema of database
-- C:\Documents and Settings\eventgenie\Desktop\db\eventgenie_41.db

BEGIN TRANSACTION;


DROP TABLE activitylogs;

DROP TABLE assets;

DROP TABLE assets_keywords;

DROP TABLE builds;

DROP TABLE builds_keywords;

DROP TABLE charts;

DROP TABLE charts_keywords;

DROP TABLE charttemplates;

DROP TABLE charttemplates_keywords;

DROP TABLE clients;

DROP TABLE clients_apps;

DROP TABLE clients_keywords;

DROP TABLE cloudstoragelogs;

DROP TABLE cloudstoragelogs_keywords;

DROP TABLE configs;

DROP TABLE configs_keywords;

-- Adding missing table columns

ALTER TABLE downloadables ADD COLUMN hasNote BOOLEAN DEFAULT 0;

DROP TABLE errorlogs;

DROP TABLE errorlogs_keywords;

-- Adding missing table columns

ALTER TABLE exhibitors ADD COLUMN hasNote BOOLEAN DEFAULT 0;

DROP TABLE favouritepeople;

DROP TABLE favouritepeople_keywords;

CREATE TABLE favouritevisitors
(
    id INTEGER PRIMARY KEY ASC NOT NULL,
    createdBy nvarchar(50) NULL,
    _id nvarchar(500) NULL,
    modifiedBy nvarchar(50) NULL,
    importBatch nvarchar(500) NULL,
    importCameFrom nvarchar(500) NULL,
    createdDate datetime NULL,
    relatedVisitor bigint NULL,
    visitor bigint NULL,
    modifiedDate datetime NULL,
    importKey nvarchar(500) NULL,
    _namespace nvarchar(100) NULL
);

CREATE TABLE favouritevisitors_keywords
(
    seqNo bigint NOT NULL,
    _namespace nvarchar(100),
    favouritevisitors_id bigint NULL,
    keywords nvarchar(500) NULL
);

DROP TABLE help;

DROP TABLE help_children;

DROP TABLE help_keywords;

-- Adding missing table columns

ALTER TABLE poi ADD COLUMN hasNote BOOLEAN DEFAULT 0;

-- Adding missing table columns

ALTER TABLE products ADD COLUMN hasNote BOOLEAN DEFAULT 0;

DROP TABLE reports;

DROP TABLE reports_keywords;

DROP TABLE reporttemplates;

DROP TABLE reporttemplates_keywords;

-- Adding missing table columns

ALTER TABLE sessions ADD COLUMN hasNote BOOLEAN DEFAULT 0;

-- Adding missing table columns

ALTER TABLE speakers ADD COLUMN hasNote BOOLEAN DEFAULT 0;

-- Adding missing table columns

ALTER TABLE subsessions ADD COLUMN hasNote BOOLEAN DEFAULT 0;

DROP TABLE systemlogs;

DROP TABLE systemlogs_keywords;

DROP TABLE users;

DROP TABLE users_apps;

DROP TABLE users_keywords;

DROP TABLE users_UUIDs;

-- Creating table visitors from scratch (simple ALTER TABLE is not enough)

CREATE TABLE temp_visitors_534011718
(
    modifiedBy nvarchar(50) NULL,
    newPassword nvarchar(500) NULL,
    loginEmailSent bit NULL,
    password nvarchar(50) NULL,
    userType INTEGER NULL,
    username nvarchar(500) NULL,
    mugShotUrl nvarchar(500) NULL,
    timezone nvarchar(500) NULL,
    showEmail bit NULL,
    fullDescription text NULL,
    showTwitter bit NULL,
    messageDebits INTEGER NULL,
    lastNames nvarchar(100) NULL,
    createdDate datetime NULL,
    firstNames nvarchar(100) NULL,
    meetingDebits INTEGER NULL,
    showYouTubeUrl bit NULL,
    companyName nvarchar(100) NULL,
    createdBy nvarchar(50) NULL,
    showBriefDescription bit NULL,
    showBlogUrl bit NULL,
    actionTypesLastRanOn text NULL,
    showReasonForAttending bit NULL,
    showVisitorType bit NULL,
    showFullDescription bit NULL,
    messageCredits INTEGER NULL,
    importKey nvarchar(500) NULL,
    showJobTitle bit NULL,
    hasSetProfile bit NULL,
    meetingCredits INTEGER NULL,
    department nvarchar(100) NULL,
    locale nvarchar(10) NULL,
    reasonForAttending nvarchar(500) NULL,
    showInterests bit NULL,
    mugShot bigint NULL,
    contact_youtubeUrl nvarchar(255) NULL,
    contact_twitter nvarchar(255) NULL,
    contact_linkedIn nvarchar(255) NULL,
    contact_fax nvarchar(100) NULL,
    contact_telephone2 nvarchar(100) NULL,
    contact_email nvarchar(100) NULL,
    contact_facebook nvarchar(255) NULL,
    contact_www nvarchar(255) NULL,
    contact_telephone nvarchar(100) NULL,
    contact_blogUrl nvarchar(255) NULL,
    id INTEGER PRIMARY KEY ASC NOT NULL,
    showLinkedIn bit NULL,
    showDepartment bit NULL,
    showFax bit NULL,
    title nvarchar(20) NULL,
    showTelephone2 bit NULL,
    showName bit NULL,
    _id nvarchar(500) NULL,
    briefDescription nvarchar(500) NULL,
    importBatch nvarchar(500) NULL,
    showAddress bit NULL,
    showCompanyName bit NULL,
    jobTitle nvarchar(500) NULL,
    lastAccessed datetime NULL,
    showMugShot bit NULL,
    importCameFrom nvarchar(500) NULL,
    showWww bit NULL,
    modifiedDate datetime NULL,
    showTelephone bit NULL,
    visitorGroup nvarchar(50) NULL,
    showFacebook bit NULL,
    address_county nvarchar(100) NULL,
    address_postCode nvarchar(45) NULL,
    address_address1 nvarchar(100) NULL,
    address_address2 nvarchar(100) NULL,
    address_town nvarchar(100) NULL,
    address_address3 nvarchar(100) NULL,
    address_country nvarchar(50) NULL,
    visitorType nvarchar(500) NULL,
    urbanAirshipAPID nvarchar(500) NULL,
    exhibitor bigint NULL,
    showMe bit NULL,
    _namespace nvarchar(100) NULL,
    isFavourite BOOLEAN DEFAULT 0,
    hasNote BOOLEAN DEFAULT 0
);

-- Copying rows from original table to the new table

INSERT INTO temp_visitors_534011718 (modifiedBy,newPassword,loginEmailSent,password,userType,username,mugShotUrl,timezone,showEmail,fullDescription,showTwitter,messageDebits,lastNames,createdDate,firstNames,meetingDebits,showYouTubeUrl,companyName,createdBy,showBriefDescription,showBlogUrl,showReasonForAttending,showVisitorType,showFullDescription,messageCredits,importKey,showJobTitle,hasSetProfile,meetingCredits,department,locale,reasonForAttending,showInterests,mugShot,contact_youtubeUrl,contact_twitter,contact_linkedIn,contact_fax,contact_telephone2,contact_email,contact_facebook,contact_www,contact_telephone,contact_blogUrl,id,showLinkedIn,showDepartment,showFax,title,showTelephone2,showName,_id,briefDescription,importBatch,showAddress,showCompanyName,jobTitle,lastAccessed,showMugShot,importCameFrom,showWww,modifiedDate,showTelephone,visitorGroup,showFacebook,address_county,address_postCode,address_address1,address_address2,address_town,address_address3,address_country,visitorType,urbanAirshipAPID,exhibitor,showMe,_namespace,actionTypesLastRanOn,isFavourite,hasNote) SELECT modifiedBy,newPassword,loginEmailSent,password,userType,username,mugShotUrl,timezone,showEmail,fullDescription,showTwitter,messageDebits,lastNames,createdDate,firstNames,meetingDebits,showYouTubeUrl,companyName,createdBy,showBriefDescription,showBlogUrl,showReasonForAttending,showVisitorType,showFullDescription,messageCredits,importKey,showJobTitle,hasSetProfile,meetingCredits,department,locale,reasonForAttending,showInterests,mugShot,contact_youtubeUrl,contact_twitter,contact_linkedIn,contact_fax,contact_telephone2,contact_email,contact_facebook,contact_www,contact_telephone,contact_blogUrl,id,showLinkedIn,showDepartment,showFax,title,showTelephone2,showName,_id,briefDescription,importBatch,showAddress,showCompanyName,jobTitle,lastAccessed,showMugShot,importCameFrom,showWww,modifiedDate,showTelephone,visitorGroup,showFacebook,address_county,address_postCode,address_address1,address_address2,address_town,address_address3,address_country,visitorType,urbanAirshipAPID,exhibitor,showMe,_namespace,NULL AS actionTypesLastRanOn,(0) AS isFavourite,(0) AS hasNote FROM visitors;

-- Droping the original table and renaming the temporary table

DROP TABLE visitors;
ALTER TABLE temp_visitors_534011718 RENAME TO visitors;

COMMIT TRANSACTION;
